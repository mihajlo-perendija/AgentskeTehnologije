(this["webpackJsonpchat-client"]=this["webpackJsonpchat-client"]||[]).push([[0],{25:function(e,t,a){e.exports=a(39)},30:function(e,t,a){},31:function(e,t,a){},36:function(e,t,a){},37:function(e,t,a){},38:function(e,t,a){},39:function(e,t,a){"use strict";a.r(t);var s=a(0),n=a.n(s),r=a(20),i=a.n(r),l=a(24),o=a(4),c=a(5),u=a(7),d=a(6),m=a(10),g=a(9),p=a(21),h=(a(30),a(13)),v=(a(31),function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var s;return Object(o.a)(this,a),(s=t.call(this,e)).onChange=function(e){s.setState(Object(h.a)({},e.target.name,e.target.value),s.validateInput)},s.onSubmit=function(e){e.preventDefault(),s.setState({submitted:!0},s.sendRegisterRequest)},s.sendRegisterRequest=function(){s.validateInput((function(){if(s.state.usernameAlertHidden&&s.state.passwordAlertHidden&&s.state.confirmPasswordAlertHidden){var e={method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({username:s.state.username,password:s.state.password})};fetch("rest/chat/users/register",e).then((function(e){e.ok?(alert("Successfuly registered"),s.setState({registered:!0})):alert("Username already exists")})).catch((function(e){console.log(e)}))}}))},s.state={username:"",password:"",confirmPassword:"",submitted:!1,usernameAlertHidden:!0,passwordAlertHidden:!0,confirmPasswordAlertHidden:!0,registered:!1},s}return Object(c.a)(a,[{key:"validateInput",value:function(e){this.state.submitted&&this.setState({usernameAlertHidden:this.usernameValid(),passwordAlertHidden:this.passwordValid(),confirmPasswordAlertHidden:this.confirmPasswordValid()},e)}},{key:"usernameValid",value:function(){return this.state.username.length>3}},{key:"passwordValid",value:function(){return this.state.password.length>5}},{key:"confirmPasswordValid",value:function(){return this.state.password===this.state.confirmPassword}},{key:"render",value:function(){return!0===this.state.registered?n.a.createElement(g.a,{to:"/login"}):n.a.createElement("div",null,n.a.createElement("form",{onSubmit:this.onSubmit,id:"register_form"},n.a.createElement("h2",{id:"register_h2"},"Sign Up"),n.a.createElement("p",{className:"register_p"},n.a.createElement("input",{className:"register_input",type:"text",name:"username",placeholder:"Username",value:this.state.username,onChange:this.onChange}),n.a.createElement("span",{className:"register_span",style:{visibility:this.state.usernameAlertHidden?"hidden":"visible"}},"Enter a username longer than 4 characters")),n.a.createElement("p",{className:"register_p"},n.a.createElement("input",{className:"register_input",type:"password",name:"password",placeholder:"Password",value:this.state.password,onChange:this.onChange}),n.a.createElement("span",{className:"register_span",style:{visibility:this.state.passwordAlertHidden?"hidden":"visible"}},"Enter a password longer than 5 characters")),n.a.createElement("p",{className:"register_p"},n.a.createElement("input",{className:"register_input",type:"password",name:"confirmPassword",placeholder:"Confirm password",value:this.state.confirmPassword,onChange:this.onChange}),n.a.createElement("span",{className:"register_span",style:{visibility:this.state.confirmPasswordAlertHidden?"hidden":"visible"}},"Your passwords do not match")),n.a.createElement("p",{className:"register_p"},n.a.createElement("input",{className:"register_input",type:"submit",value:"Create My Account",id:"submit"}))))}}]),a}(s.Component)),f=(a(36),function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var s;return Object(o.a)(this,a),(s=t.call(this,e)).onChange=function(e){s.setState(Object(h.a)({},e.target.name,e.target.value),s.validateInput)},s.onSubmit=function(e){e.preventDefault(),s.setState({submitted:!0},s.sendLoginRequest)},s.sendLoginRequest=function(){s.validateInput((function(){if(s.state.usernameAlertHidden&&s.state.passwordAlertHidden){var e={method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({username:s.state.username,password:s.state.password})};fetch("rest/chat/users/login",e).then((function(e){if(e.ok)return alert("Successfuly logged in"),e.json();alert("Invalid username or password")})).then((function(e){(null===e||void 0===e?void 0:e.username)&&s.setState({loggedInUser:e})})).catch((function(e){console.log(e)}))}}))},s.state={username:"",password:"",submitted:!1,usernameAlertHidden:!0,passwordAlertHidden:!0,loggedInUser:!1},s}return Object(c.a)(a,[{key:"validateInput",value:function(e){this.state.submitted&&this.setState({usernameAlertHidden:this.usernameValid(),passwordAlertHidden:this.passwordValid()},e)}},{key:"usernameValid",value:function(){return this.state.username.length>3}},{key:"passwordValid",value:function(){return this.state.password.length>5}},{key:"render",value:function(){return this.state.loggedInUser?(this.props.setLoggedInUser(this.state.loggedInUser),n.a.createElement(g.a,{to:"/chat"})):n.a.createElement("div",null,n.a.createElement("form",{onSubmit:this.onSubmit,id:"login_form"},n.a.createElement("h2",{id:"login_h2"},"Sign In"),n.a.createElement("p",{className:"login_p"},n.a.createElement("input",{className:"login_input",type:"text",name:"username",placeholder:"Username",value:this.state.username,onChange:this.onChange}),n.a.createElement("span",{className:"login_span",style:{visibility:this.state.usernameAlertHidden?"hidden":"visible"}},"Invalid username")),n.a.createElement("p",{className:"login_p"},n.a.createElement("input",{className:"login_input",type:"password",name:"password",placeholder:"Password",value:this.state.password,onChange:this.onChange}),n.a.createElement("span",{className:"login_span",style:{visibility:this.state.passwordAlertHidden?"hidden":"visible"}},"Invalid password")),n.a.createElement("p",{className:"login_p"},n.a.createElement("input",{className:"login_input",type:"submit",value:"Sign In",id:"submit"})),n.a.createElement("div",{id:"route_to_register_div"},n.a.createElement("h2",null,"Don't have an account? ",n.a.createElement(m.b,{to:"/register"},"Register"),"  "))))}}]),a}(s.Component)),E=(a(37),function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(o.a)(this,a);for(var s=arguments.length,n=new Array(s),r=0;r<s;r++)n[r]=arguments[r];return(e=t.call.apply(t,[this].concat(n))).getConversationClass=function(t){var a;return t.username===(null===(a=e.props.selectedUser)||void 0===a?void 0:a.username)?"conversation active":"conversation"},e}return Object(c.a)(a,[{key:"render",value:function(){var e=this;return 0===this.props.users.length?null:this.props.users.map((function(t){return n.a.createElement("div",{className:e.getConversationClass(t),key:t.id,onClick:e.props.selectConversation.bind(e,t)},n.a.createElement("div",{className:"title-text"},t.username),n.a.createElement("div",{className:"created-date"}),n.a.createElement("div",{className:"conversation-message"}))}))}}]),a}(s.Component)),b=(a(38),function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(o.a)(this,a);for(var s=arguments.length,n=new Array(s),r=0;r<s;r++)n[r]=arguments[r];return(e=t.call.apply(t,[this].concat(n))).getMessageClass=function(t){return t.sender===e.props.loggedInUser.username?"message-row my-message":"message-row other-message"},e}return Object(c.a)(a,[{key:"render",value:function(){var e=this;return this.props.messages?this.props.messages.slice(0).reverse().map((function(t){return n.a.createElement("div",{className:e.getMessageClass(t),key:new Date(t.timeStamp).getTime()},n.a.createElement("div",{className:"message-text"},t.text),n.a.createElement("div",null,n.a.createElement("span",{className:"message-username"},t.sender+" at "),n.a.createElement("span",{className:"message-time"},new Date(t.timeStamp).toLocaleString())))})):null}}]),a}(s.Component)),y=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(o.a)(this,a);for(var s=arguments.length,n=new Array(s),r=0;r<s;r++)n[r]=arguments[r];return(e=t.call.apply(t,[this].concat(n))).state={loggedInUser:null,users:[],selectedUser:{},text:"",visibleMessages:[]},e.selectConversation=function(t){e.setState({selectedUser:t,text:""},e.getConversationMessages)},e.getConversationMessages=function(){if("ALL"===e.state.selectedUser.username){var t=e.state.loggedInUser.messages.filter((function(e){return"ALL"===e.reciever}));e.setState({visibleMessages:t})}else{var a=e.state.loggedInUser.messages.filter((function(t){return t.sender===e.state.selectedUser.username&&t.reciever===e.state.loggedInUser.username||t.sender===e.state.loggedInUser.username&&t.reciever===e.state.selectedUser.username}));e.setState({visibleMessages:a})}},e.setLoggedInUser=function(t){e.setState({loggedInUser:t})},e.logout=function(){var t="rest/chat/users/loggedIn/".concat(e.state.loggedInUser.username);fetch(t,{method:"DELETE",headers:{"content-type":"application/json"}}).then((function(t){t.ok?e.setState({loggedInUser:null,selectedUser:null,users:[]}):alert("Error")})).catch((function(e){console.log(e)}))},e.getOnlineUsers=function(){fetch("rest/chat/users/loggedIn").then((function(e){if(e.ok)return e.json();alert("Error")})).then((function(t){e.setState({users:t.filter((function(t){return t.username!==e.state.loggedInUser.username}))})})).catch((function(e){console.log(e)}))},e.getAllUsers=function(){fetch("rest/chat/users/registered").then((function(e){if(e.ok)return e.json();alert("Error")})).then((function(t){e.setState({users:t.filter((function(t){return t.username!==e.state.loggedInUser.username}))})})).catch((function(e){console.log(e)}))},e.onMessageChange=function(t){e.setState({text:t.target.value})},e.onSendMessage=function(t){var a;t.preventDefault(),a="ALL"===e.state.selectedUser.username?"all":"user";var s={sender:e.state.loggedInUser.username,reciever:e.state.selectedUser.username,text:e.state.text,timeStamp:(new Date).getTime()},n={method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(s)},r="rest/chat/messages/".concat(a);fetch(r,n).then((function(t){if(t.ok){var a=[].concat(Object(l.a)(e.state.loggedInUser.messages),[s]),n=e.state.loggedInUser;n.messages=a,e.setState({loggedInUser:n,text:""},e.getConversationMessages)}else alert("Error")})).catch((function(e){console.log(e)}))},e.changeToAll=function(){e.setState({selectedUser:{username:"ALL"},text:""},e.getConversationMessages)},e}return Object(c.a)(a,[{key:"render",value:function(){var e=this;return n.a.createElement(m.a,{basename:"/"},n.a.createElement("div",{className:"App"},n.a.createElement(g.b,{exact:!0,path:"/",render:function(t){return n.a.createElement(n.a.Fragment,null,n.a.createElement(f,{setLoggedInUser:e.setLoggedInUser}))}}),n.a.createElement(g.b,{exact:!0,path:"/login",render:function(t){return n.a.createElement(n.a.Fragment,null,n.a.createElement(f,{setLoggedInUser:e.setLoggedInUser}))}}),n.a.createElement(g.b,{exact:!0,path:"/register",render:function(e){return n.a.createElement(n.a.Fragment,null,n.a.createElement(v,null))}}),n.a.createElement(g.b,{exact:!0,path:"/chat",render:function(t){var a,s;return n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{id:"chat-container"},n.a.createElement("div",{id:"search-container"},null!==e.state.loggedInUser?n.a.createElement("div",{className:"buttons-div"},n.a.createElement("button",{className:"users-button",onClick:e.getOnlineUsers},"Online"),n.a.createElement("button",{className:"users-button",style:{marginLeft:"20px"},onClick:e.getAllUsers},"All")):null),n.a.createElement("div",{id:"conversation-list"},n.a.createElement(E,{users:e.state.users,selectConversation:e.selectConversation,selectedUser:e.state.selectedUser})),n.a.createElement("div",{id:"lower-left-container"},null===e.state.loggedInUser?n.a.createElement("div",{className:"buttons-div"},n.a.createElement(m.b,{className:"button-link",to:"/login"},"Login"),n.a.createElement(m.b,{className:"button-link",style:{marginLeft:"20px"},to:"/register"},"Sign up")):n.a.createElement("div",{className:"buttons-div"},n.a.createElement("button",{className:"users-button",onClick:e.logout},"Logout"),"ALL"!==(null===(a=e.state.selectedUser)||void 0===a?void 0:a.username)?n.a.createElement("button",{className:"users-button",style:{marginLeft:"20px",width:"120px"},onClick:e.changeToAll},"Send to all"):null)),n.a.createElement("div",{id:"chat-title"},n.a.createElement("span",null,null===(s=e.state.selectedUser)||void 0===s?void 0:s.username)),n.a.createElement("div",{id:"chat-message-list"},null!=e.state.loggedInUser&&e.state.selectedUser?n.a.createElement(b,{messages:e.state.visibleMessages,user:e.state.selectedUser,loggedInUser:e.state.loggedInUser}):null),n.a.createElement("form",{id:"chat-form",onSubmit:e.onSendMessage},n.a.createElement("div",null,n.a.createElement("input",{type:"text",value:e.state.text,placeholder:"type a message",onChange:e.onMessageChange,style:{width:"80%"}}),n.a.createElement("input",{type:"submit",value:"Send"})))))}})),n.a.createElement(p.a,{name:"main-component",data:this.state,debounce:500,onMount:function(t){return e.setState(t)}}))}}]),a}(s.Component);i.a.render(n.a.createElement(n.a.StrictMode,null,n.a.createElement(y,null)),document.getElementById("root"))}},[[25,1,2]]]);
//# sourceMappingURL=main.08cb8766.chunk.js.map